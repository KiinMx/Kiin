sequenceDiagram
    participant XLSX as üìÅ Excel (.xlsx)
    participant DAO as CoursesModelDAO
    participant API as API Routes (/api/*)
    participant LS as üóÑÔ∏è localStorage
    participant DS as Client DataSources
    participant MAP as Mapper
    participant UI as üñ•Ô∏è Generador Page
    participant SG as ScheduleGenerator

    Note over XLSX,DAO: Carga inicial (lazy, una sola vez)
    API->>DAO: globalInitialLoad()
    DAO->>XLSX: Leer archivo m√°s reciente
    XLSX-->>DAO: Datos crudos
    DAO->>DAO: Excel ‚Üí CSV ‚Üí CourseCSV[]
    DAO->>API: Entities (Course, Subject, Degree, Professor)

    Note over API,DS: Petici√≥n del cliente
    DS->>API: GET /api/version
    API-->>DS: "1.4.1_20.05.2025"
    DS->>LS: ¬øExiste cache con esta versi√≥n?

    alt Cache v√°lido
        LS-->>DS: Datos JSON cacheados
    else Cache inv√°lido o inexistente
        DS->>API: GET /api/courses/all (+ degrees, subjects, professors)
        API-->>DS: JSON[]
        DS->>LS: Guardar con clave "entity-info-{versi√≥n}"
        DS->>LS: Limpiar versiones anteriores
    end

    DS->>MAP: JSON plano
    MAP-->>DS: Entidades rehidratadas (Course[], Subject[], etc.)

    Note over UI,SG: Generaci√≥n en el cliente
    UI->>UI: Usuario selecciona filtros
    UI->>DS: Obtener cursos filtrados (FilterImpl)
    DS-->>UI: Course[] filtrados
    UI->>SG: generateSchedules(courses)
    SG-->>UI: Schedule[]
    UI->>UI: Aplicar pins + pivots + slider
    UI->>UI: Renderizar calendario + paginaci√≥n
